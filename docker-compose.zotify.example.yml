# Example Docker Compose with Zotify Integration
# Copy this file and rename to docker-compose.yml or use with -f flag
# Usage: docker-compose -f docker-compose.zotify.example.yml up -d

version: '3.9'

services:
  ytdlp-api:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: ytdlp-api-zotify
    ports:
      - "8080:8080"
    volumes:
      # Downloads directory - for both yt-dlp and Zotify content
      - ./downloads:/app/downloads
      
      # Config directory - contains both .conf (yt-dlp) and .json (Zotify) files
      - ./configs:/app/configs
      
      # Credentials directory - for cookies, Spotify credentials, etc.
      - ./credentials:/app/credentials
      
      # Optional: Archive directory for tracking downloaded files
      - ./archive:/app/archive
    
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
      # Optional: Timezone
      - TZ=Europe/Berlin
    
    # Health check
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/api/healthcheck/ready"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    
    # Restart policy
    restart: unless-stopped
    
    # Resource limits (optional)
    # deploy:
    #   resources:
    #     limits:
    #       cpus: '2'
    #       memory: 1G
    #     reservations:
    #       cpus: '1'
    #       memory: 512M
    
    # Network (optional)
    # networks:
    #   - media-network

# networks:
#   media-network:
#     driver: bridge

volumes:
  downloads:
    driver: local
  configs:
    driver: local
  credentials:
    driver: local
  archive:
    driver: local
